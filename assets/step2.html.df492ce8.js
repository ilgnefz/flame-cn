import{_ as p,r as o,o as c,c as l,a as i,b as a,w as e,F as u,e as t,d as n}from"./app.0106d251.js";const d={},r=t(`<h1 id="_2-\u811A\u624B\u67B6" tabindex="-1"><a class="header-anchor" href="#_2-\u811A\u624B\u67B6" aria-hidden="true">#</a> 2. \u811A\u624B\u67B6</h1><p>\u5728\u8FD9\u4E00\u90E8\u5206\uFF0C\u6211\u4EEC\u5C06\u7528\u7C97\u7EBF\u6761\u52FE\u52D2\u51FA\u6E38\u620F\u7684\u4E3B\u8981\u5143\u7D20\u3002\u8FD9\u5305\u62EC\u6E38\u620F\u7684\u4E3B\u7C7B\u548C\u603B\u4F53\u5E03\u5C40\u3002</p><h2 id="klondikegame" tabindex="-1"><a class="header-anchor" href="#klondikegame" aria-hidden="true">#</a> KlondikeGame</h2><p>\u5728 Flame \u5B87\u5B99\u4E2D\uFF0C<strong>FlameGame</strong> \u662F\u5927\u591A\u6570\u6E38\u620F\u7684\u57FA\u77F3\u3002\u8FD9\u4E2A\u7C7B\u8FD0\u884C\u6E38\u620F\u5FAA\u73AF\uFF0C\u8C03\u5EA6\u4E8B\u4EF6\uFF0C\u62E5\u6709\u7EC4\u6210\u6E38\u620F\u7684\u6240\u6709\u7EC4\u4EF6(\u7EC4\u4EF6\u6811) \uFF0C\u901A\u5E38\u8FD8\u5145\u5F53\u6E38\u620F\u72B6\u6001\u7684\u4E2D\u5FC3\u5B58\u50A8\u5E93\u3002</p><p>\u56E0\u6B64\uFF0C\u5728 <code>lib/</code> \u6587\u4EF6\u5939\u4E2D\u521B\u5EFA\u4E00\u4E2A\u540D\u4E3A <code>KlondikeGame. dart</code> \u7684\u65B0\u6587\u4EF6\uFF0C\u5E76\u5728\u5176\u4E2D\u58F0\u660E <code>KlondikeGame</code> \u7C7B\uFF1A</p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/game.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">KlondikeGame</span> <span class="token keyword">extends</span> <span class="token class-name">FlameGame</span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">void</span><span class="token punctuation">&gt;</span></span> <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token class-name">Flame</span><span class="token punctuation">.</span>images<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;klondike-sprites.png&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u73B0\u5728\u6211\u4EEC\u53EA\u58F0\u660E\u4E86 <code>onLoad</code> \u65B9\u6CD5\uFF0C\u8FD9\u662F\u4E00\u4E2A\u7279\u6B8A\u7684\u5904\u7406\u7A0B\u5E8F\uFF0C\u5F53\u6E38\u620F\u5B9E\u4F8B\u7B2C\u4E00\u6B21\u9644\u52A0\u5230 Flutter \u5C0F\u90E8\u4EF6\u6811\u65F6\u8C03\u7528\u5B83\u3002\u60A8\u53EF\u4EE5\u5C06\u5176\u770B\u4F5C\u4E00\u4E2A\u5EF6\u8FDF\u7684\u5F02\u6B65\u6784\u9020\u51FD\u6570\u3002\u76EE\u524D\uFF0C<code>onLoad</code> \u552F\u4E00\u505A\u7684\u4E8B\u60C5\u5C31\u662F\u5C06\u7CBE\u7075\u56FE\u50CF\u52A0\u8F7D\u5230\u6E38\u620F\u4E2D; \u4F46\u662F\u6211\u4EEC\u5F88\u5FEB\u5C31\u4F1A\u6DFB\u52A0\u66F4\u591A\u7684\u7CBE\u7075\u56FE\u50CF\u3002\u8981\u5728\u6E38\u620F\u4E2D\u4F7F\u7528\u7684\u4EFB\u4F55\u56FE\u50CF\u6216\u5176\u4ED6\u8D44\u6E90\u90FD\u9700\u8981\u9996\u5148\u52A0\u8F7D\uFF0C\u8FD9\u662F\u4E00\u4E2A\u76F8\u5BF9\u7F13\u6162\u7684 i/o \u64CD\u4F5C\uFF0C\u56E0\u6B64\u9700\u8981\u4F7F\u7528 <code>await</code> \u5173\u952E\u5B57\u3002</p><p>\u6211\u6B63\u5728\u5C06\u56FE\u50CF\u52A0\u8F7D\u5230\u5168\u5C40 <code>Flame.images</code> \u7F13\u5B58\u4E2D\u3002\u53E6\u4E00\u79CD\u65B9\u6CD5\u662F\u5C06\u5176\u52A0\u8F7D\u5230\u6E38\u620F\u4E2D\u7684<code> images</code> \u7F13\u5B58\u4E2D\uFF0C\u4F46\u662F\u4ECE\u5176\u4ED6\u7C7B\u8BBF\u95EE\u8FD9\u4E2A\u6620\u50CF\u4F1A\u66F4\u52A0\u56F0\u96BE\u3002</p><p>\u8FD8\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u5728\u521D\u59CB\u5316\u6E38\u620F\u4E2D\u7684\u5176\u4ED6\u5185\u5BB9\u4E4B\u524D\uFF0C\u6211\u6B63\u5728 <code>await</code> \u56FE\u50CF\u5B8C\u6210\u52A0\u8F7D\u3002\u8FD9\u662F\u4E3A\u4E86\u65B9\u4FBF\uFF1A\u8FD9\u610F\u5473\u7740\u5728\u521D\u59CB\u5316\u6240\u6709\u5176\u4ED6\u7EC4\u4EF6\u65F6\uFF0C\u5B83\u4EEC\u53EF\u4EE5\u5047\u5B9A\u5DF2\u7ECF\u52A0\u8F7D\u4E86\u7CBE\u7075\u8868\u3002\u6211\u4EEC\u751A\u81F3\u53EF\u4EE5\u6DFB\u52A0\u4E00\u4E2A\u8F85\u52A9\u51FD\u6570\u6765\u4ECE\u666E\u901A\u7684\u7CBE\u7075\u8868\u4E2D\u63D0\u53D6\u7CBE\u7075\u56FE\uFF1A</p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code><span class="token class-name">Sprite</span> <span class="token function">klondikeSprite</span><span class="token punctuation">(</span>double x<span class="token punctuation">,</span> double y<span class="token punctuation">,</span> double width<span class="token punctuation">,</span> double height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token class-name">Sprite</span><span class="token punctuation">(</span>
    <span class="token class-name">Flame</span><span class="token punctuation">.</span>images<span class="token punctuation">.</span><span class="token function">fromCache</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;klondike-sprites.png&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    srcPosition<span class="token punctuation">:</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>
    srcSize<span class="token punctuation">:</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u4E2A\u8F85\u52A9\u51FD\u6570\u5728\u672C\u7AE0\u4E2D\u4E0D\u9700\u8981\uFF0C\u4F46\u5728\u4E0B\u4E00\u7AE0\u4E2D\u5C06\u88AB\u5E7F\u6CDB\u4F7F\u7528\u3002</p><p>\u8BA9\u6211\u4EEC\u628A\u8FD9\u4E2A\u7C7B\u5408\u5E76\u5230\u9879\u76EE\u4E2D\uFF0C\u8FD9\u6837\u5B83\u5C31\u4E0D\u4F1A\u88AB\u5B64\u7ACB\u3002\u6253\u5F00 <code>main.dart</code> \u627E\u5230\u5199\u7740 <code>final game = FlameGame()</code> \u7684\u884C; \u5E76\u7528 <code>KlondikeGame</code> \u66FF\u6362 <code>FlameGame</code>\u3002\u60A8\u8FD8\u9700\u8981\u5BFC\u5165\u7C7B\u3002\u5B8C\u6210\u6240\u6709\u64CD\u4F5C\u4E4B\u540E\uFF0C\u6587\u4EF6\u5E94\u8BE5\u662F\u8FD9\u6837\u7684\uFF1A</p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/game.dart&#39;</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flutter/widgets.dart&#39;</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;klondike_game.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> game <span class="token operator">=</span> <span class="token class-name">KlondikeGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">runApp</span><span class="token punctuation">(</span><span class="token class-name">GameWidget</span><span class="token punctuation">(</span>game<span class="token punctuation">:</span> game<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5176\u4ED6\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u5176\u4ED6\u7C7B" aria-hidden="true">#</a> \u5176\u4ED6\u7C7B</h2><p>\u5230\u76EE\u524D\u4E3A\u6B62\uFF0C\u6211\u4EEC\u5DF2\u7ECF\u6709\u4E86\u4E3B\u8981\u7684 <code>KlondikeGame</code> \u7C7B\uFF0C\u73B0\u5728\u6211\u4EEC\u9700\u8981\u521B\u5EFA\u8981\u6DFB\u52A0\u5230\u6E38\u620F\u4E2D\u7684\u5BF9\u8C61\u3002 \u5728 <code>Flame</code> \u4E2D\uFF0C\u8FD9\u4E9B\u5BF9\u8C61\u79F0\u4E3A\u7EC4\u4EF6\uFF0C\u5F53\u6DFB\u52A0\u5230\u6E38\u620F\u4E2D\u65F6\uFF0C\u5B83\u4EEC\u4F1A\u5F62\u6210\u201C\u6E38\u620F\u7EC4\u4EF6\u6811\u201D\u3002 \u6E38\u620F\u4E2D\u5B58\u5728\u7684\u6240\u6709\u5B9E\u4F53\u90FD\u5FC5\u987B\u662F\u7EC4\u4EF6\u3002</p><p>\u6B63\u5982\u6211\u4EEC\u5728\u4E0A\u4E00\u7AE0\u4E2D\u5DF2\u7ECF\u63D0\u5230\u7684\uFF0C\u6211\u4EEC\u7684\u6E38\u620F\u4E3B\u8981\u7531\u5361\u7247\u7EC4\u4EF6\u7EC4\u6210\u3002 \u7136\u800C\uFF0C\u7531\u4E8E\u7ED8\u5236\u5361\u7247\u9700\u8981\u4E00\u4E9B\u52AA\u529B\uFF0C\u6211\u4EEC\u5C06\u628A\u8BE5\u7C7B\u7684\u5B9E\u73B0\u63A8\u8FDF\u5230\u4E0B\u4E00\u7AE0\u3002</p><p>\u73B0\u5728\uFF0C\u8BA9\u6211\u4EEC\u521B\u5EFA\u5BB9\u5668\u7C7B\uFF0C\u5982\u8349\u56FE\u6240\u793A\u3002\u8FD9\u4E9B\u662F\uFF1A<code>Stock</code>\u3001<code>Waste</code>\u3001<code>Pile</code> \u548C <code>Foundation</code>\u3002\u5728\u9879\u76EE\u76EE\u5F55\u4E2D\u521B\u5EFA\u4E00\u4E2A\u5B50\u76EE\u5F55\u7EC4\u4EF6\uFF0C\u7136\u540E\u521B\u5EFA\u6587\u4EF6 <code>components/stock.dart</code>\u3002\u5728\u8BE5\u6587\u4EF6\u4E2D\u5199\u5165\uFF1A</p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/components.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Stock</span> <span class="token keyword">extends</span> <span class="token class-name">PositionComponent</span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  bool <span class="token keyword">get</span> debugMode <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u8FD9\u91CC\uFF0C\u6211\u4EEC\u5C06 <code>Stock</code> \u7C7B\u58F0\u660E\u4E3A <code>PositionComponent</code>\uFF08\u8FD9\u662F\u4E00\u4E2A\u5177\u6709\u4F4D\u7F6E\u548C\u5927\u5C0F\u7684\u7EC4\u4EF6\uFF09\u3002\u6211\u4EEC\u8FD8\u6253\u5F00\u4E86\u8FD9\u4E2A\u7C7B\u7684\u8C03\u8BD5\u6A21\u5F0F\uFF0C\u4EE5\u4FBF\u6211\u4EEC\u53EF\u4EE5\u5728\u5C4F\u5E55\u4E0A\u770B\u5230\u5B83\uFF0C\u5373\u4F7F\u6211\u4EEC\u8FD8\u6CA1\u6709\u4EFB\u4F55\u5448\u73B0\u903B\u8F91\u3002</p><p>\u540C\u6837\u5730\uFF0C\u5728\u76F8\u5E94\u7684\u6587\u4EF6\u4E2D\u521B\u5EFA\u53E6\u5916\u4E09\u4E2A\u7C7B <code>Foundation</code>\u3001 <code>Pile</code> \u548C <code>Waste</code>\u3002\u73B0\u5728\u6240\u6709\u56DB\u4E2A\u7C7B\u7684\u5185\u90E8\u903B\u8F91\u5B8C\u5168\u76F8\u540C\uFF0C\u6211\u4EEC\u5C06\u5728\u540E\u9762\u7684\u7AE0\u8282\u4E2D\u4E3A\u8FD9\u4E9B\u7C7B\u6DFB\u52A0\u66F4\u591A\u7684\u529F\u80FD\u3002</p><p>\u73B0\u5728\u60A8\u6E38\u620F\u7684\u76EE\u5F55\u7ED3\u6784\u5E94\u8BE5\u662F\u8FD9\u6837\u7684\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>klondike/
 \u251C\u2500assets/
 \u2502  \u2514\u2500images/
 \u2502     \u2514\u2500klondike-sprites.png
 \u251C\u2500lib/
 \u2502  \u251C\u2500components/
 \u2502  \u2502  \u251C\u2500foundation.dart
 \u2502  \u2502  \u251C\u2500pile.dart
 \u2502  \u2502  \u251C\u2500stock.dart
 \u2502  \u2502  \u2514\u2500waste.dart
 \u2502  \u251C\u2500klondike_game.dart
 \u2502  \u2514\u2500main.dart
 \u251C\u2500analysis_options.yaml
 \u2514\u2500pubspec.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u6E38\u620F\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#\u6E38\u620F\u7ED3\u6784" aria-hidden="true">#</a> \u6E38\u620F\u7ED3\u6784</h2><p>\u4E00\u65E6\u6211\u4EEC\u62E5\u6709\u4E86\u4E00\u4E9B\u57FA\u672C\u7EC4\u4EF6\uFF0C\u6211\u4EEC\u4FBF\u9700\u8981\u5C06\u5B83\u4EEC\u6DFB\u52A0\u5230\u6E38\u620F\u4E2D\u3002\u662F\u65F6\u5019\u51B3\u5B9A\u6E38\u620F\u7684\u9AD8\u7EA7\u7ED3\u6784\u4E86\u3002</p>`,24),k=n("\u8FD9\u91CC\u5B58\u5728\u591A\u79CD\u65B9\u6CD5\uFF0C\u5B83\u4EEC\u5728\u590D\u6742\u6027\u3001\u53EF\u6269\u5C55\u6027\u548C\u603B\u4F53\u539F\u7406\u65B9\u9762\u6709\u6240\u4E0D\u540C\u3002\u6211\u4EEC\u5C06\u5728\u672C\u6559\u7A0B\u4E2D\u91C7\u7528\u7684\u65B9\u6CD5\u662F\u57FA\u4E8E\u4F7F\u7528 "),m=n("World"),v=n(" \u7EC4\u4EF6\u548C "),b=n("Camera"),g=n("\u3002"),h=t(`<p>\u8FD9\u79CD\u65B9\u6CD5\u80CC\u540E\u7684\u60F3\u6CD5\u662F\u8FD9\u6837\u7684\uFF1A\u60F3\u8C61\u60A8\u7684\u6E38\u620F\u4E16\u754C\u72EC\u7ACB\u4E8E\u8BBE\u5907\u5B58\u5728\uFF0C\u5B83\u5DF2\u7ECF\u5B58\u5728\u4E8E\u6211\u4EEC\u7684\u5934\u8111\u4E2D\uFF0C\u5B58\u5728\u4E8E\u8349\u56FE\u4E2D\uFF0C\u5373\u4F7F\u6211\u4EEC\u8FD8\u6CA1\u6709\u505A\u4EFB\u4F55\u7F16\u7801\u3002\u8FD9\u4E2A\u4E16\u754C\u5C06\u6709\u4E00\u5B9A\u7684\u5927\u5C0F\uFF0C\u4E16\u754C\u4E0A\u7684\u6BCF\u4E2A\u5143\u7D20\u5C06\u6709\u4E00\u5B9A\u7684\u5750\u6807\u3002\u8FD9\u53D6\u51B3\u4E8E\u6211\u4EEC\u6765\u51B3\u5B9A\u4E16\u754C\u7684\u5927\u5C0F\uFF0C\u4EE5\u53CA\u8FD9\u4E2A\u5927\u5C0F\u7684\u5EA6\u91CF\u5355\u4F4D\u662F\u4EC0\u4E48\u3002\u91CD\u8981\u7684\u662F\uFF0C\u4E16\u754C\u662F\u72EC\u7ACB\u4E8E\u8BBE\u5907\u5B58\u5728\u7684\uFF0C\u5B83\u7684\u5C3A\u5BF8\u540C\u6837\u4E0D\u4F9D\u8D56\u4E8E\u5C4F\u5E55\u7684\u50CF\u7D20\u5206\u8FA8\u7387\u3002</p><p>\u6240\u6709\u5C5E\u4E8E\u4E16\u754C\u7684\u5143\u7D20\u90FD\u5C06\u88AB\u6DFB\u52A0\u5230 <code>World</code> \u7EC4\u4EF6\u4E2D\uFF0C\u7136\u540E <code>World</code> \u7EC4\u4EF6\u4E5F\u5C06\u88AB\u6DFB\u52A0\u5230\u6E38\u620F\u4E2D\u3002</p><p>\u6574\u4E2A\u7ED3\u6784\u7684\u7B2C\u4E8C\u90E8\u5206\u662F\u4E00\u4E2A\u76F8\u673A\uFF08<code>CamerComponent</code>\uFF09\u3002\u76F8\u673A\u7684\u76EE\u7684\u662F\u89C2\u5BDF\u4E16\u754C\uFF0C\u786E\u4FDD\u5728\u7528\u6237\u8BBE\u5907\u7684\u5C4F\u5E55\u4E0A\u4EE5\u6B63\u786E\u7684\u5C3A\u5BF8\u5448\u73B0\u3002</p><p>\u56E0\u6B64\uFF0C\u7EC4\u4EF6\u6811\u7684\u603B\u4F53\u7ED3\u6784\u5927\u81F4\u5982\u4E0B\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>KlondikeGame
 \u251C\u2500 World
 \u2502   \u251C\u2500 Stock
 \u2502   \u251C\u2500 Waste
 \u2502   \u251C\u2500 Foundation (\xD74)
 \u2502   \u2514\u2500 Pile (\xD77)
 \u2514\u2500 CameraComponent
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container warning"><p class="custom-container-title">\u6CE8\u610F</p><p>\u672C\u6559\u7A0B\u4E2D\u63CF\u8FF0\u7684 Camera \u7CFB\u7EDF\u4E0D\u540C\u4E8E\u4F5C\u4E3A FlameGame \u7C7B\u5C5E\u6027\u53EF\u7528\u7684\u201Cofficial\u201D Camera\u3002\u540E\u8005\u5728\u672A\u6765\u53EF\u80FD\u4F1A\u88AB\u5F03\u7528\u3002</p></div><p>\u5BF9\u4E8E\u8FD9\u4E2A\u6E38\u620F\uFF0C\u6211\u4E00\u76F4\u5728\u7ED8\u5236\u6211\u7684\u56FE\u50CF\u8D44\u4EA7\uFF0C\u8003\u8651\u5230\u4E00\u5F20\u5361\u7684\u5C3A\u5BF8\u4E3A 1000 * 1400 \u50CF\u7D20\u3002\u56E0\u6B64\uFF0C\u8FD9\u5C06\u4F5C\u4E3A\u786E\u5B9A\u6574\u4F53\u5E03\u5C40\u7684\u53C2\u8003\u5927\u5C0F\u3002\u53E6\u4E00\u4E2A\u5F71\u54CD\u5E03\u5C40\u7684\u91CD\u8981\u5EA6\u91CF\u662F\u5361\u95F4\u8DDD\u79BB\u3002\u5B83\u4F3C\u4E4E\u5E94\u8BE5\u5728 150 \u5230 200 \u4E2A\u5355\u5143\u4E4B\u95F4(\u76F8\u5BF9\u4E8E\u5361\u5BBD\u5EA6)\uFF0C\u56E0\u6B64\u6211\u4EEC\u5C06\u5B83\u58F0\u660E\u4E3A\u4E00\u4E2A\u53D8\u91CF <code>cardGap</code>\uFF0C\u5982\u679C\u9700\u8981\u7684\u8BDD\uFF0C\u53EF\u4EE5\u5728\u4EE5\u540E\u8FDB\u884C\u8C03\u6574\u3002\u4E3A\u7B80\u5355\u8D77\u89C1\uFF0C\u5782\u76F4\u548C\u6C34\u5E73\u7684\u5361\u7247\u95F4\u8DDD\u5C06\u76F8\u540C\uFF0C\u5E76\u4E14\u5361\u7247\u4E0E\u5C4F\u5E55\u8FB9\u7F18\u4E4B\u95F4\u7684\u6700\u5C0F\u586B\u5145\u4E5F\u5C06\u7B49\u4E8E <code>cardGap</code>\u3002</p><p>\u597D\u4E86\uFF0C\u8BA9\u6211\u4EEC\u628A\u8FD9\u4E9B\u653E\u5728\u4E00\u8D77\uFF0C\u5B9E\u73B0\u6211\u4EEC\u7684 <code>KlondikeGame</code> \u7C7B\u3002</p><p>\u9996\u5148\uFF0C\u6211\u4EEC\u58F0\u660E\u51E0\u4E2A\u5168\u5C40\u5E38\u91CF\u63CF\u8FF0\u5C3A\u5BF8\u548C\u5361\u7247\u4E4B\u95F4\u7684\u8DDD\u79BB\u3002\u6211\u4EEC\u5C06\u5B83\u4EEC\u58F0\u660E\u4E3A\u5E38\u91CF\uFF0C\u56E0\u4E3A\u6211\u4EEC\u4E0D\u6253\u7B97\u5728\u6E38\u620F\u4E2D\u66F4\u6539\u8FD9\u4E9B\u503C\uFF1A</p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code>  <span class="token keyword">static</span> <span class="token keyword">const</span> double cardWidth <span class="token operator">=</span> <span class="token number">1000.0</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> double cardHeight <span class="token operator">=</span> <span class="token number">1400.0</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> double cardGap <span class="token operator">=</span> <span class="token number">175.0</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> double cardRadius <span class="token operator">=</span> <span class="token number">100.0</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Vector2</span> cardSize <span class="token operator">=</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>cardWidth<span class="token punctuation">,</span> cardHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\uFF0C\u6211\u4EEC\u5C06\u521B\u5EFA\u4E00\u4E2A <code>Stock</code> \u7EC4\u4EF6\u3001<code>Waste</code>\u30014\u4E2A <code>Foundations </code>\u548C\u4E03\u4E2A <code>pile</code>\uFF0C\u8BBE\u7F6E\u5B83\u4EEC\u5728\u4E16\u754C\u4E2D\u7684\u5927\u5C0F\u548C\u4F4D\u7F6E\u3002 \u4F7F\u7528\u7B80\u5355\u7684\u7B97\u672F\u8BA1\u7B97\u4F4D\u7F6E\u3002 \u8FD9\u4E00\u5207\u90FD\u5E94\u8BE5\u53D1\u751F\u5728 <code>onLoad</code> \u65B9\u6CD5\u4E2D\uFF0C\u5728\u52A0\u8F7D spritesheet \u4E4B\u540E\uFF1A</p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code>    <span class="token keyword">final</span> stock <span class="token operator">=</span> <span class="token class-name">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>size <span class="token operator">=</span> cardSize
      <span class="token punctuation">.</span><span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>cardGap<span class="token punctuation">,</span> cardGap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> waste <span class="token operator">=</span> <span class="token class-name">Waste</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>size <span class="token operator">=</span> cardSize
      <span class="token punctuation">.</span><span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>cardWidth <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> cardGap<span class="token punctuation">,</span> cardGap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> foundations <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>
      <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token class-name">Foundation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span>size <span class="token operator">=</span> cardSize
        <span class="token punctuation">.</span><span class="token punctuation">.</span>position <span class="token operator">=</span>
            <span class="token class-name">Vector2</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>cardWidth <span class="token operator">+</span> cardGap<span class="token punctuation">)</span> <span class="token operator">+</span> cardGap<span class="token punctuation">,</span> cardGap<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> piles <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>
      <span class="token number">7</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token class-name">Pile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span>size <span class="token operator">=</span> cardSize
        <span class="token punctuation">.</span><span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>
          cardGap <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>cardWidth <span class="token operator">+</span> cardGap<span class="token punctuation">)</span><span class="token punctuation">,</span>
          cardHeight <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> cardGap<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7136\u540E\u6211\u4EEC\u521B\u5EFA\u4E3B\u8981\u7684 <code>World</code> \u7EC4\u4EF6\uFF0C\u6DFB\u52A0\u6211\u4EEC\u521A\u521A\u521B\u5EFA\u7684\u6240\u6709\u7EC4\u4EF6\uFF0C\u6700\u540E\u5C06 <code>World</code> \u6DFB\u52A0\u5230\u6E38\u620F\u4E2D\u3002</p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code>    <span class="token keyword">final</span> world <span class="token operator">=</span> <span class="token class-name">World</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>stock<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>waste<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>foundations<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>piles<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">add</span><span class="token punctuation">(</span>world<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>You may be wondering when you need to \`await\` the result of \`add()\`, and when
you don&#39;t. The short answer is: usually you don&#39;t need to wait, but if you want
to, then it won&#39;t hurt either.

If you check the documentation for \`.add()\` method, you&#39;ll see that the returned
future only waits until the component is finished loading, not until it is
actually mounted to the game. As such, you only have to wait for the future from
\`.add()\` if your logic requires that the component is fully loaded before it can
proceed. This is not very common.

If you don&#39;t \`await\` the future from \`.add()\`, then the component will be added
to the game anyways, and in the same amount of time.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container warning"><p class="custom-container-title">\u6CE8\u610F</p><p>\u60A8\u53EF\u80FD\u60F3\u77E5\u9053\u4EC0\u4E48\u65F6\u5019\u9700\u8981\u7B49\u5F85 <code>add()</code> \u7684\u7ED3\u679C\uFF0C\u4EC0\u4E48\u65F6\u5019\u4E0D\u9700\u8981\u3002 \u7B80\u77ED\u7684\u56DE\u7B54\u662F\uFF1A\u901A\u5E38\u60A8\u4E0D\u9700\u8981\u7B49\u5F85\uFF0C\u4F46\u5982\u679C\u60A8\u613F\u610F\uFF0C\u90A3\u4E48\u4E5F\u4E0D\u4F1A\u6709\u4EC0\u4E48\u95EE\u9898\u3002</p><p>\u5982\u679C\u60A8\u67E5\u770B <code>.add()</code> \u65B9\u6CD5\u7684\u6587\u6863\uFF0C\u60A8\u4F1A\u770B\u5230\u8FD4\u56DE\u7684 future \u53EA\u7B49\u5230\u7EC4\u4EF6\u5B8C\u6210\u52A0\u8F7D\uFF0C\u800C\u4E0D\u662F\u76F4\u5230\u5B83\u5B9E\u9645\u5B89\u88C5\u5230\u6E38\u620F\u4E2D\u3002 \u56E0\u6B64\uFF0C\u5982\u679C\u60A8\u7684\u903B\u8F91\u8981\u6C42\u7EC4\u4EF6\u5728\u7EE7\u7EED\u4E4B\u524D\u5B8C\u5168\u52A0\u8F7D\uFF0C\u60A8\u53EA\u9700\u7B49\u5F85 <code>.add()</code> \u7684 Future\u3002 \u8FD9\u79CD\u60C5\u51B5\u5E76\u4E0D\u5E38\u89C1\u3002</p></div><p>\u6700\u540E\uFF0C\u6211\u4EEC\u521B\u5EFA\u4E00\u4E2A\u6444\u50CF\u673A\u5BF9\u8C61\u6765\u89C2\u5BDF\u8FD9\u4E2A\u4E16\u754C\u3002\u5728\u5185\u90E8\uFF0C\u76F8\u673A\u7531\u4E24\u90E8\u5206\u7EC4\u6210\uFF1A\u89C6\u53E3\u548C\u53D6\u666F\u5668\u3002\u9ED8\u8BA4\u7684\u89C6\u53E3\u662F <code>MaxViewport</code>\uFF0C\u5B83\u5360\u7528\u4E86\u6574\u4E2A\u53EF\u7528\u7684\u5C4F\u5E55\u5927\u5C0F\u2014\u2014\u8FD9\u6B63\u662F\u6211\u4EEC\u7684\u6E38\u620F\u6240\u9700\u8981\u7684\uFF0C\u6240\u4EE5\u4E0D\u9700\u8981\u6539\u53D8\u4EFB\u4F55\u4E1C\u897F\u3002\u53E6\u4E00\u65B9\u9762\uFF0C\u53D6\u666F\u5668\u7684\u8BBE\u7F6E\u9700\u8981\u8003\u8651\u5230\u5E95\u5C42\u4E16\u754C\u7684\u5C3A\u5BF8\u3002</p><p>\u6211\u4EEC\u5E0C\u671B\u6574\u4E2A\u5361\u7247\u5E03\u5C40\u5728\u5C4F\u5E55\u4E0A\u53EF\u89C1\uFF0C\u800C\u65E0\u9700\u6EDA\u52A8\u3002 \u4E3A\u4E86\u5B9E\u73B0\u8FD9\u4E00\u70B9\uFF0C\u6211\u4EEC\u6307\u5B9A\u6211\u4EEC\u5E0C\u671B\u6574\u4E2A\u4E16\u754C\u5927\u5C0F\uFF08\u5373 <code>7*cardWidth + 8*cardGap x 4*cardHeight + 3*cardGap</code>\uFF09\u80FD\u591F\u9002\u5E94\u5C4F\u5E55\u3002 <code>.visibleGameSize</code> \u8BBE\u7F6E\u786E\u4FDD\u65E0\u8BBA\u8BBE\u5907\u5927\u5C0F\u5982\u4F55\uFF0C\u7F29\u653E\u7EA7\u522B\u90FD\u5C06\u88AB\u8C03\u6574\uFF0C\u4EE5\u4FBF\u6E38\u620F\u4E16\u754C\u7684\u6307\u5B9A\u5757\u53EF\u89C1\u3002</p><p>\u6E38\u620F\u5927\u5C0F\u7684\u8BA1\u7B97\u65B9\u6CD5\u662F\u8FD9\u6837\u7684: \u753B\u9762\u4E2D\u6709 7 \u5F20\u5361\u7247\uFF0C\u5B83\u4EEC\u4E4B\u95F4\u6709 6 \u4E2A\u95F4\u9699\uFF0C\u518D\u52A0\u4E0A 2 \u4E2A\u201C\u95F4\u9699\u201D\u6765\u586B\u5145\uFF0C\u60A8\u5C31\u5F97\u5230\u4E86 <code>7 * cardWidth + 8 * cardGap</code> \u7684\u5BBD\u5EA6\u3002\u5782\u76F4\u65B9\u5411\u4E0A\u6709\u4E24\u6392\u724C\uFF0C\u4F46\u662F\u5728\u5E95\u4E0B\u4E00\u6392\u6211\u4EEC\u9700\u8981\u4E00\u4E9B\u989D\u5916\u7684\u7A7A\u95F4\u6765\u663E\u793A\u4E00\u5806\u9AD8\u7684\u724C\u2014\u2014\u636E\u6211\u7C97\u7565\u4F30\u8BA1\uFF0C\u4E00\u5F20\u724C\u7684\u9AD8\u5EA6\u4E09\u500D\u5C31\u8DB3\u591F\u4E86\u2014\u2014\u8FD9\u5C31\u7ED9\u51FA\u4E86\u6E38\u620F\u4E16\u754C\u7684\u603B\u9AD8\u5EA6\u4E3A <code>4 * cardHeight + 3 * cardGap</code>\u3002</p><p>\u63A5\u4E0B\u6765\uFF0C\u6211\u4EEC\u6307\u5B9A\u4E16\u754C\u7684\u54EA\u4E00\u90E8\u5206\u5C06\u4F4D\u4E8E\u89C6\u533A\u7684\u201C\u4E2D\u5FC3\u201D\u3002\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u6211\u6307\u5B9A\u89C6\u56FE\u7AEF\u53E3\u7684\u201C\u4E2D\u5FC3\u201D\u5E94\u8BE5\u4F4D\u4E8E\u5C4F\u5E55\u7684\u9876\u90E8\u4E2D\u5FC3\uFF0C\u6E38\u620F\u4E16\u754C\u4E2D\u7684\u5BF9\u5E94\u70B9\u4F4D\u4E8E\u5750\u6807 <code>[(7*cardWidth + 8*cardGap)/2, 0]</code>.</p><p>\u8FD9\u6837\u9009\u62E9\u53D6\u666F\u5668\u7684\u4F4D\u7F6E\u548C\u951A\u70B9\u7684\u539F\u56E0\u662F\uFF0C\u5982\u679C\u6E38\u620F\u5C3A\u5BF8\u53D8\u5F97\u592A\u5BBD\u6216\u592A\u9AD8\uFF0C\u6211\u4EEC\u5E0C\u671B\u5B83\u7684\u53CD\u5E94\uFF1A\u5982\u679C\u592A\u5BBD\uFF0C\u6211\u4EEC\u5E0C\u671B\u5B83\u5C45\u4E2D\u5728\u5C4F\u5E55\u4E0A\uFF0C\u4F46\u5982\u679C\u5C4F\u5E55\u592A\u9AD8\uFF0C\u6211\u4EEC\u5E0C\u671B\u5185\u5BB9\u5728\u9876\u90E8\u5BF9\u9F50\u3002</p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code>    <span class="token keyword">final</span> camera <span class="token operator">=</span> <span class="token class-name">CameraComponent</span><span class="token punctuation">(</span>world<span class="token punctuation">:</span> world<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>viewfinder<span class="token punctuation">.</span>visibleGameSize <span class="token operator">=</span>
          <span class="token class-name">Vector2</span><span class="token punctuation">(</span>cardWidth <span class="token operator">*</span> <span class="token number">7</span> <span class="token operator">+</span> cardGap <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">*</span> cardHeight <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> cardGap<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>viewfinder<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>cardWidth <span class="token operator">*</span> <span class="token number">3.5</span> <span class="token operator">+</span> cardGap <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>viewfinder<span class="token punctuation">.</span>anchor <span class="token operator">=</span> <span class="token class-name">Anchor</span><span class="token punctuation">.</span>topCenter<span class="token punctuation">;</span>
    <span class="token function">add</span><span class="token punctuation">(</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u60A8\u73B0\u5728\u8FD0\u884C\u6E38\u620F\uFF0C\u60A8\u5E94\u8BE5\u4F1A\u770B\u5230\u4E0D\u540C\u7EC4\u4EF6\u7684\u5360\u4F4D\u7B26\u3002\u5982\u679C\u60A8\u662F\u5728\u6D4F\u89C8\u5668\u4E2D\u8FD0\u884C\u6E38\u620F\uFF0C\u8BD5\u7740\u8C03\u6574\u7A97\u53E3\u5927\u5C0F\uFF0C\u770B\u770B\u6E38\u620F\u5BF9\u6B64\u6709\u4F55\u53CD\u5E94\u3002</p><h2 id="\u4EE3\u7801" tabindex="-1"><a class="header-anchor" href="#\u4EE3\u7801" aria-hidden="true">#</a> \u4EE3\u7801</h2><p><em>components/foundation.dart</em></p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/components.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Foundation</span> <span class="token keyword">extends</span> <span class="token class-name">PositionComponent</span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  bool <span class="token keyword">get</span> debugMode <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>components/pile.dart</em></p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/components.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Pile</span> <span class="token keyword">extends</span> <span class="token class-name">PositionComponent</span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  bool <span class="token keyword">get</span> debugMode <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>components/stock.dart</em></p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/components.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Stock</span> <span class="token keyword">extends</span> <span class="token class-name">PositionComponent</span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  bool <span class="token keyword">get</span> debugMode <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>components/waste.dart</em></p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/components.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Waste</span> <span class="token keyword">extends</span> <span class="token class-name">PositionComponent</span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  bool <span class="token keyword">get</span> debugMode <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>klondike_game.dart</em></p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/components.dart&#39;</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/experimental.dart&#39;</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/flame.dart&#39;</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/game.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;components/foundation.dart&#39;</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;components/pile.dart&#39;</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;components/stock.dart&#39;</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;components/waste.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">KlondikeGame</span> <span class="token keyword">extends</span> <span class="token class-name">FlameGame</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> double cardGap <span class="token operator">=</span> <span class="token number">175.0</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> double cardWidth <span class="token operator">=</span> <span class="token number">1000.0</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> double cardHeight <span class="token operator">=</span> <span class="token number">1400.0</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> double cardRadius <span class="token operator">=</span> <span class="token number">100.0</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Vector2</span> cardSize <span class="token operator">=</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>cardWidth<span class="token punctuation">,</span> cardHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">void</span><span class="token punctuation">&gt;</span></span> <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token class-name">Flame</span><span class="token punctuation">.</span>images<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;klondike-sprites.png&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">final</span> stock <span class="token operator">=</span> <span class="token class-name">Stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>size <span class="token operator">=</span> cardSize
      <span class="token punctuation">.</span><span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>cardGap<span class="token punctuation">,</span> cardGap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> waste <span class="token operator">=</span> <span class="token class-name">Waste</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>size <span class="token operator">=</span> cardSize
      <span class="token punctuation">.</span><span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>cardWidth <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> cardGap<span class="token punctuation">,</span> cardGap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> foundations <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>
      <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token class-name">Foundation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span>size <span class="token operator">=</span> cardSize
        <span class="token punctuation">.</span><span class="token punctuation">.</span>position <span class="token operator">=</span>
            <span class="token class-name">Vector2</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>cardWidth <span class="token operator">+</span> cardGap<span class="token punctuation">)</span> <span class="token operator">+</span> cardGap<span class="token punctuation">,</span> cardGap<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> piles <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>
      <span class="token number">7</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token class-name">Pile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span>size <span class="token operator">=</span> cardSize
        <span class="token punctuation">.</span><span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>
          cardGap <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>cardWidth <span class="token operator">+</span> cardGap<span class="token punctuation">)</span><span class="token punctuation">,</span>
          cardHeight <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> cardGap<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">final</span> world <span class="token operator">=</span> <span class="token class-name">World</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>stock<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>waste<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>foundations<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>piles<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">add</span><span class="token punctuation">(</span>world<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">final</span> camera <span class="token operator">=</span> <span class="token class-name">CameraComponent</span><span class="token punctuation">(</span>world<span class="token punctuation">:</span> world<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>viewfinder<span class="token punctuation">.</span>visibleGameSize <span class="token operator">=</span>
          <span class="token class-name">Vector2</span><span class="token punctuation">(</span>cardWidth <span class="token operator">*</span> <span class="token number">7</span> <span class="token operator">+</span> cardGap <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">*</span> cardHeight <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> cardGap<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>viewfinder<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>cardWidth <span class="token operator">*</span> <span class="token number">3.5</span> <span class="token operator">+</span> cardGap <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span>viewfinder<span class="token punctuation">.</span>anchor <span class="token operator">=</span> <span class="token class-name">Anchor</span><span class="token punctuation">.</span>topCenter<span class="token punctuation">;</span>
    <span class="token function">add</span><span class="token punctuation">(</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">Sprite</span> <span class="token function">klondikeSprite</span><span class="token punctuation">(</span>double x<span class="token punctuation">,</span> double y<span class="token punctuation">,</span> double width<span class="token punctuation">,</span> double height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token class-name">Sprite</span><span class="token punctuation">(</span>
    <span class="token class-name">Flame</span><span class="token punctuation">.</span>images<span class="token punctuation">.</span><span class="token function">fromCache</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;klondike-sprites.png&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    srcPosition<span class="token punctuation">:</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>
    srcSize<span class="token punctuation">:</span> <span class="token class-name">Vector2</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>main.dart</em></p><div class="language-dart ext-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flame/game.dart&#39;</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;package:flutter/widgets.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">&#39;klondike_game.dart&#39;</span></span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> game <span class="token operator">=</span> <span class="token class-name">KlondikeGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">runApp</span><span class="token punctuation">(</span><span class="token class-name">GameWidget</span><span class="token punctuation">(</span>game<span class="token punctuation">:</span> game<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7\u8FD9\u4E00\u6B65\uFF0C\u6211\u4EEC\u5DF2\u7ECF\u521B\u5EFA\u4E86\u57FA\u672C\u7684\u6E38\u620F\u7ED3\u6784\uFF0C\u5176\u4ED6\u6240\u6709\u5185\u5BB9\u90FD\u5C06\u57FA\u4E8E\u6B64\u6784\u5EFA\u3002\u5728\u4E0B\u4E00\u6B65\u4E2D\uFF0C\u6211\u4EEC\u5C06\u5B66\u4E60\u5982\u4F55\u6E32\u67D3\u5361\u7247\u5BF9\u8C61\uFF0C\u8FD9\u662F\u6E38\u620F\u4E2D\u6700\u91CD\u8981\u7684\u89C6\u89C9\u5BF9\u8C61\u3002</p>`,37);function w(f,y){const s=o("RouterLink");return c(),l(u,null,[r,i("p",null,[k,a(s,{to:"/guide/flame/camera-component.html#world"},{default:e(()=>[m]),_:1}),v,a(s,{to:"/guide/flame/camera-component.html#cameracomponent"},{default:e(()=>[b]),_:1}),g]),h],64)}var x=p(d,[["render",w],["__file","step2.html.vue"]]);export{x as default};
